---
layout: post
tags: 贝叶斯统计 主题模型
---

LDA最主要的参数是主题-词条矩阵。回想LDA的模型假设，它认为主题是关于词条的多项式分布即$$Multinomial(\vec p_k)$$, 其中$$\vec p_k = (p_{k,1}, p_{k,2}, ..., p_{k,V})$$, V为词汇量大小。若语料中共有$$K$$个主题，那么就相应地有$$K$$个不同的多项式分布，总共有$$KV$$个参数，这就是所谓的"主题-词条矩阵"，记为$$\beta = (\vec p_1, ..., \vec p_K)$$.

根据贝叶斯统计的思想，要估计$$\beta$$, 需要求解后验概率分布的极大值解，而后验概率分布的计算需要2个要素：先验分布、似然函数：

1. 先验分布，在这里指的是每一个主题的多项式分布参数，以第k个主题为例，即$$\vec p_k = (p_{k,1}, p_{k,2}, ..., p_{k,V})$$所服从的分布，记为$$prior(\vec p_k)$$.

2. 似然函数是指参数已知的前提下，观测数据的出现概率，即$$P(X;\beta)$$, 这里指的是已知各个主题在词条上的分布参数时，各个主题对应词频的联合概率分布。

有了以上2点，后验分布就可由贝叶斯定理得出，是一个关于$$\beta$$的函数。

这和普通的贝叶斯统计框架并无差异，最简单的例子见[伯努利分布的贝叶斯参数估计](https://nomadcube.github.io/2017/04/04/%E4%BC%AF%E5%8A%AA%E5%88%A9%E5%88%86%E5%B8%83%E7%9A%84%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/).

LDA的特别在于它的先验分布。在[伯努利分布的贝叶斯参数估计](https://nomadcube.github.io/2017/04/04/%E4%BC%AF%E5%8A%AA%E5%88%A9%E5%88%86%E5%B8%83%E7%9A%84%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/)中可以看到设置的先验分布是离散分布，而对应的后验分布也是一个普通的离散分布，通过枚举就可以求得极大值解。而LDA的精妙之处是用狄利克雷分布作为先验分布，这样的好处是使得后验分布也是一个狄利克雷分布，只不过参数被似然函数修正过。

LDA有这样的性质主要是因为这个事实：狄利克雷分布和多项分布的乘积也是一个狄利克雷分布。这从直觉上理解是很简单的，不妨退化到二维的情况下作类比：

1. 在二维的情况下，狄利克雷分布退化成beta分布，记为$$beta(a, b)$$，均值为$$\frac{a}{a + b}$$. 

2. 而多项分布退化到二维则是一个参数为$$\theta$$二项分布。对于n次试验而言，成功了s次。

3. 综上并结合贝叶斯定理得后验分布为$$beta(a + s - 1, b + n - s - 1 )$$. 这相当于根据试验的成功/失败比例将先验分布的均值往左或往右拉。

后验分布公式推导如下：

【1】prior设为$$f(\theta) = \frac{\Gamma(a) \Gamma(b)}{\Gamma(a + b)} \theta^{a-1} (1- \theta)^{b-1}$$

【2】似然函数为$$P(X;\theta) = C_{n}^{s} \theta^s (1 - \theta)^{(n - s)}$$

【3】后验分布为$$f(\theta; X) = \frac{f(X;\theta)f(\theta)}{\int f(X;\theta)f(\theta) d(\theta)}$$

【4】【3】中分子分母中$$f(X;\theta)f(\theta)$$包含的项$$\frac{\Gamma(a) \Gamma(b)}{\Gamma(a+b)} C_{n}^{s}$$为常数，可约去，得$$f(\theta; X) = \frac{1}{\int \theta^{a+s-1} (1-\theta)^{b+n-s-1} d(\theta)} \theta^{s + a - 1} (1 - \theta)^{n - s + b - 1}$$

【5】【4】中$$\int \theta^{a+s-1} (1-\theta)^{b+n-s-1} d(\theta)$$由于$$\theta$$取值在[0,1]区间内，因此这正好是B函数的形式，即$$\frac{\Gamma(a+s) \Gamma(b+n-s)}{\Gamma(a+b+n)}$$

【6】由【5】得后验分布$$f(\theta; X) = \frac{\Gamma(a+s) \Gamma(b+n-s)}{\Gamma(a+b+n)} \theta^{s + a - 1} (1 - \theta)^{n - s + b - 1} = beta(a+s-1, b+n-s-1)$$

将以上推导和结论推广到n维空间，就可以得到狄利克雷分布和多项分布的关系的结论。

当人的经验不足时，先验分布可以设得尽量"随机"，比如在离散分布时可以设成简单的均匀分布。而对于狄利克雷分布来说，是否"均匀"取决于狄利克雷分布的超参数。特别在，在对称狄利克雷分布上，超参数可以设得尽可能接近1，这样狄利克雷分布对应的一个高维平面就更"平"，也就是说认为每个可能性都是接近于"平等"的。
