---
layout: post
tags: 机器学习
---

### gamma函数
gamma函数是阶乘在复数集上的扩展, 因此当$$n$$为正整数时, $$\Gamma(n) = n!$$。

### B函数
B函数也称为beta函数, 和gamma函数的关系: $$B(\alpha, \beta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)}$$。

### beta分布
beta分布的常数项由B函数构成, 概率密度函数为$$f(x; \alpha, \beta) = \frac{1}{B(\alpha, \beta)} x^{\alpha-1}(1-x)^{\beta-1}$$

### 贝叶斯定理
在离散先验分布下, 贝叶斯定理可以表示为$$P(A|B) = \frac{P(B|A)P(A)}{\sum_{i} P(B|A_i)P(A_i)}$$。在连续先验分布下表示为$$f(x|y) = \frac{f(y|x)f(x)}{\int f(y|x)f(x) dx}$$.

### 二项分布、beta分布和共轭
当先验分布为beta分布, 数据分布服从二项分布, 后验分布同样为beta分布, 这时beta分布也称为二项分布的共轭分布。推导如下:

1. 二项分布的参数$$\theta ~ beta(\alpha, \beta)$$, 即$$f(\theta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)} \theta^{\alpha-1}(1-\theta)^{\beta-1}$$

2. 观测数据服从二项分布, 即$$X ~ Binomial(\theta)$$, 于是$$X$$的似然函数为$$L(X;\theta) = C_{n}^{s} \theta^s (1 - \theta)^{(n - s)}$$, 其中$$n, s$$分别代表试验次数和成功次数

3. 在以上两个假设下, 后验分布的密度函数为$$f(\theta;X) = \frac{f(X;\theta)f(\theta)}{\int f(X;\theta)f(\theta) d(\theta)}$$, 其中$$f(X;\theta)f(\theta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)} C_{n}^{s} \theta^{s + \alpha-1} (1 - \theta)^(n - s + \beta-1)$$, 代入后验分布的密度函数并约去常数项$$\frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)} C_{n}^{s}$$后, $$f(\theta;X) = \frac{\theta^{s + \alpha-1} (1 - \theta)^(n - s + \beta-1)}{\int \theta^{s + \alpha-1} (1 - \theta)^(n - s + \beta-1) d\theta}$$, 这正是beta分布的形式, 参数分别为$$s + \alpha, n-s+\beta$$, 因此后验分布服从beta分布$$beta(s + \alpha, n-s+\beta)$$.

另一个事实是, beta分布的均值为$$\frac{\alpha}{\alpha + \beta}$$, 因此当观测数据将先验beta分布的均值向左或右"拉", 处于先验分布和后验分布均值之间, 相当于使得后验分布同时符合先验知识和观测数据所表达的信息。
